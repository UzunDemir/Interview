# Interview

# Разработка и обучение модели, предсказывающей совершение клиентами целевых действий на сайте autopodpiska.ru

### Описание работы

**Проект:** Построение и внедрение реальных ML-моделей для предсказания поведения клиентов на платформе autopodpiska.ru

**Цель:** Повысить конверсию пользователей в платных подписчиков и улучшить удержание клиентов с помощью персонализированных рекомендаций и таргетинга.

---

### Технологии и инструменты

* **ML-фреймворки:** PyTorch и TensorFlow — для построения и обучения нейросетевых моделей.
* **Обработка больших данных:** Apache Spark — для масштабируемой обработки пользовательских данных и обучения моделей на больших объемах.
* **Данные:** Логины, поведенческие данные (время на сайте, действия, переходы по страницам), демография, история покупок.
* **Метрики:** Конверсия (conversion rate), удержание (retention rate), A/B-тестирование для оценки эффективности моделей.

---

### Основные этапы и вызовы

1. **Подготовка данных:**

   * Интеграция данных из разных источников (CRM, веб-аналитика, базы данных).
   * Очистка и нормализация данных, обработка пропусков.
   * Создание признаков (фичей) на основе временных рядов и событий.

2. **Построение моделей:**

   * Использование PyTorch для кастомных нейросетевых архитектур, учитывающих последовательность действий пользователей (RNN, Transformer).
   * TensorFlow применялся для более быстрых экспериментов с CNN и DNN.
   * Spark MLlib использовался для масштабируемого обучения моделей на большом объеме данных.

3. **Обучение и валидация:**

   * Разделение данных на train/validation/test.
   * Использование кросс-валидации и метрик AUC-ROC, Precision\@K для оценки качества моделей.
   * Балансировка классов из-за дисбаланса в данных (мало конверсий относительно общего числа пользователей).

4. **Внедрение и мониторинг:**

   * Развертывание модели в реальном времени через API.
   * Постоянный мониторинг метрик и корректировка модели по мере накопления новых данных.

---

### Метрики и результаты

* **+12% конверсии:**
  Конверсия считалась как отношение количества пользователей, совершивших целевое действие (подписка) к общему числу посетителей.
  Формула:

  $$
  \text{Conversion Rate} = \frac{\text{Количество подписавшихся}}{\text{Количество посетителей}}
  $$

  Результаты сравнивались до и после внедрения ML-модели с помощью A/B-теста.
  Разница в конверсии между контрольной группой и группой с моделью составила +12%.

* **+8% удержания:**
  Удержание измерялось как доля пользователей, вернувшихся и оставшихся активными через 30 дней после подписки.
  Формула:


  Retention Rate= 
Общее количество подписавшихся
Количество пользователей, вернувшихся через 30 дней
​


  Аналогично, результаты удержания были подтверждены с помощью анализа когорт и A/B-тестов.

---

### Трудности

* Большой объем и разнородность данных, необходимость быстрой и стабильной обработки в режиме реального времени.
* Балансировка классов — конверсия по умолчанию низкая, что требовало специальных техник (oversampling, focal loss).
* Интеграция модели в продакшен с минимальной задержкой отклика.
* Поддержка модели в актуальном состоянии — постоянное переобучение на новых данных.

---

